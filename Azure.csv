Azure Monitor が収集するデータ,,,,,
,,,,,
Azure Monitor はさまざまなソースからデータを収集できます。 アプリケーションやそれが依存するオペレーティング システムやサービスから、プラットフォーム自体に至るまで、アプリケーションのさまざまな階層のデータ監視を検討することができます。 Azure Monitor は、以下のそれぞれの層からデータを収集します。,,,,,
アプリケーション監視データ:プラットフォームを問わず、記述したコードのパフォーマンスと機能に関するデータ。,,,,,
ゲスト OS 監視データ:アプリケーションが実行されているオペレーティング システムに関するデータ。 これは Azure、別のクラウド、またはオンプレミスで実行できます。,,,,,
Azure リソース監視データ:Azure リソースの操作に関するデータ。,,,,,
Azure サブスクリプション監視データ:Azure サブスクリプションの操作および管理に関するデータと、Azure 自体の正常性および操作に関するデータ。,,,,,
Azure テナントの監視データ:Azure Active Directory など、テナント レベルの Azure サービスの操作に関するデータ。,,,,,
,,,,,
Azure サブスクリプションを作成して仮想マシンや Web アプリなどのリソースを追加すると、Azure Monitor は即座にデータの収集を開始します。 リソースが作成または変更されると、アクティビティ ログが記録されます。 リソースの状況や消費しているリソースは、メトリックからわかります。,,,,,
データの収集をリソースの実運用にまで拡張するには、診断を有効にしてコンピューティング リソースにエージェントを追加します。 これによって、リソースの内部操作に関する利用統計情報が収集されるようになり、さまざまなデータ ソースを構成して Windows および Linux ゲスト オペレーティング システムからログやメトリックを収集することができます。,,,,,
App Services アプリケーションまたは VM および仮想マシン スケール セット アプリケーションの監視を有効にすると、Application Insights が有効になり、ページ ビュー、アプリケーションの要求、例外など、アプリケーションに関する詳細情報を収集できます。 さらにアプリケーションの可用性を検証するには、ユーザー トラフィックをシミュレートする可用性テストを構成します。,,,,,
,,,,,
カスタム ソース,,,,,
Azure Monitor では、Data Collector API を使用して任意の REST クライアントからログ データを収集できます。 これにより、カスタム監視シナリオを作成し、他のソースを通じてテレメトリが公開されないリソースも監視対象に含めることができます。,,,,,
,,,,,
洞察,,,,,
データの監視が役立つのは、コンピューティング環境の運用の可視性が高まる場合のみです。 Azure Monitor には、アプリケーションやそれが依存するリソースに対する貴重な洞察を提供するいくつかの機能やツールが含まれています。 Application Insights やコンテナーに対する Azure Monitor などの監視ソリューションと機能では、アプリケーションや特定の Azure サービスのさまざまな側面に対する詳細な分析情報が提供されます。,,,,,
Application Insights,,,,,
Application Insights は、クラウドとオンプレミスのどちらにホストされているかにかかわらず、Web アプリケーションの可用性、パフォーマンス、使用状況を監視します。 Azure Monitor の強力なデータ分析プラットフォームを利用し、ユーザーの報告を待つことなく、アプリケーション運用やエラー診断に対する深い洞察を提供します。 Application Insights にはさまざまな開発ツールへの接続ポイントが含まれており、DevOps プロセスをサポートする Visual Studio とも統合されています。,,,,,
,,,,,
コンテナーに対する Azure Monitor,,,,,
コンテナー向けの Azure Monitor は、Azure Kubernetes Service (AKS) でホストされるマネージド Kubernetes クラスターにデプロイされているコンテナー ワークロードのパフォーマンスを監視するために設計された機能です。 Kubernetes で使用可能なコントローラー、ノード、およびコンテナーから Metrics API 経由でメモリやプロセッサ メトリックを収集することにより、パフォーマンスを可視化します。 コンテナーのログも収集されます。 Kubernetes クラスターから監視を有効化すると、コンテナー化されたバージョンの Linux 向けの Log Analytics エージェントを使用してこれらのメトリックとログが自動的に収集されます。,,,,,
,,,,,
VM に対する Azure Monitor,,,,,
Azure Monitor for VMs では、お使いの Azure 仮想マシン (VM) の大規模な監視が行われます。それを行うために、さまざまなプロセスや、その他のリソースおよび外部プロセスに対する相互接続された依存関係など、Windows および Linux VM のパフォーマンスと正常性が分析されます。 このソリューションでは、オンプレミスまたは別のクラウド プロバイダーでホストされている VM について、パフォーマンスおよびアプリケーションの依存関係の監視もサポートされています。,,,,,
,,,,,
監視ソリューション,,,,,
Azure Monitor の監視ソリューションは、特定のアプリケーションまたはサービスに関する洞察を提供するロジックを 1 つにまとめたものです。 アプリケーションまたはサービスの監視データを収集するためのロジック、そのデータを分析するためのクエリ、視覚化のためのビューが含まれています。 Azure サービスおよび他のアプリケーションを監視するさまざまな監視ソリューションが Microsoft とパートナーから提供されています。,,,,,
,,,,,
重大な状況への応答,,,,,
効果的な監視ソリューションは、対話形式で監視データを分析できるだけでなく、収集したデータから危機的な状況を識別して事前に応答できる必要があります。 たとえば、問題の調査を担当する管理者にテキストまたはメールを送信することが考えられます。 または、自動化されたプロセスを起動して、エラー状態の修正を試みることも考えられます。,,,,,
アラート,,,,,
Azure Monitor のアラートは、重大な状態を事前に通知し、可能であれば修正のためのアクションを実行しようとします。 メトリックに基づくアラート ルールは、数値に基づくリアルタイムに近いアラートを提供します。一方、ログに基づくルールを使うと、複数のソースのデータにまたがる複雑なロジックを実現できます。,,,,,
Azure Monitor のアラート ルールは、受信者の一意なセットと複数のルール間で共有できるアクションを含むアクション グループを使用します。 アクション グループを使うと、Webhook を使用してアラートから外部アクションを起動したり、ITSM ツールと統合したりするなど、要件に基づいたアクションを実行することができます。,,,,,
,,,,,
自動スケール,,,,,
自動スケールを使用すると、適切な量のリソースを実行して、アプリケーションに対する負荷を処理することができます。 Azure Monitor が収集したメトリックを使用して、負荷の増加に対応するために自動的にリソースを追加するタイミングや、アイドル状態にあるリソースを削除してコストを節約するタイミングを判別するルールを作成することができます。 インスタンスの最小数および最大数と、リソースを増減するタイミングを示すロジックを指定します。,,,,,
,,,,,
監視データの視覚化,,,,,
グラフや表などによる視覚化は、監視データをまとめてさまざまな対象ユーザーに提示する際に利用できる効果的なツールです。 Azure Monitor は、監視データを視覚化する独自の機能を備えており、他の Azure サービスを活用してさまざまな対象ユーザーに公開します。,,,,,
,,,,,
ダッシュボード,,,,,
Azure ダッシュボードを使用すると、メトリックとログを含むさまざまな種類のデータを組み合わせて Azure portal 内の 1 つのウィンドウに表示できます。 ダッシュボードは、他の Azure ユーザーと共有することもできます。 Azure Monitor のすべての要素は、任意のログ クエリやメトリック グラフの出力と合わせて、Azure ダッシュ ボードに追加できます。 たとえば、メトリックのグラフ、アクティビティ ログの表、Application Insights の使用状況グラフ、ログ クエリ結果を示すタイルを組み合わせて 1 つのダッシュボードを作成できます。,,,,,
,,,,,
ビュー,,,,,
ビューは Azure Monitor でログ データを視覚的に表現します。 それぞれのビューには単一のタイルが含まれており、ドリルダウンすることで重要なデータを集約したリストのほか、棒グラフや折れ線グラフなど、さまざまな視覚化要素を表示できます。 監視ソリューションには、特定の用途向けにデータを集計したビューが含まれているほか、ログ クエリから得たデータを表示する独自のビューを作成することもできます。 ビューは、Azure Monitor での他の要素と同様に、Azure ダッシュ ボードに追加できます。,,,,,
,,,,,
Power BI,,,,,
Power BIは、さまざまなデータ ソースを対話操作で視覚化するビジネス分析サービスで、データを組織内外のユーザーと効果的に共有することができます。 Azure Monitor からログ データを自動的にインポートするように Power BI を構成すると、そのデータも追加で視覚化することができます。,,,,,
,,,,,
データの統合とエクスポート,,,,,
多くの場合、監視データを使用するカスタム ソリューションを構築するために、Azure Monitor と他のシステムを統合したいという要件があります。 このような統合を実現するには、他の Azure サービスと Azure Monitor を連携させます。,,,,,
,,,,,
,,,,,
,,,,,
,,,,,
,,,,,
,,,,,
,,,,,
,,,,,
,,,,,
,,,,,
,,,,,
料金,,,,,
サービス,機能,含まれている無料ユニット,料金,,
Log Analytics,データ インジェスト,顧客あたり 5 GB / 月,¥374.08/GB,,
,データ保持,31 日,1 GB あたり ¥16.80/月,,
Application Insights,データ インジェスト,顧客あたり 5 GB / 月,¥374.08/GB ,,
,データ保持,90 日,該当なし,,
,複数ステップ Web テスト,なし,利用不可 /テスト/月,,
,Web テストの ping,無制限,Free,,
メトリック,標準メトリック,無制限,"Free
https://docs.microsoft.com/ja-jp/azure/azure-monitor/platform/data-platform-metrics","プラットフォームのメトリック
ゲスト OS メトリック
アプリケーション メトリック",
,カスタム メトリック,150 MB/月,"¥28.896/MB: 150 - 100,000 MB
¥16.912/MB: 100,000 - 250,000 MB
¥6.832/MB: 250,000 MB 超",,
,メトリック クエリ,"1,000,000 標準 API 呼び出し/月","¥1.12/1,000 標準 API 呼び出し",,
正常性監視,正常性の基準,なし,監視対象メトリック時系列あたり ¥11.200 個 (1 か月あたり),,
アラート ルール,"メトリック9, 10",監視対象メトリック時系列 10 個 (1 か月あたり),監視対象メトリック時系列 1 つにつき ¥11.200 (1 か月あたり),,
,ログ,なし,15 分以上の間隔: 監視対象ログ 1 つにつき ¥56 (1 か月あたり),,
,,,10 分間隔: 監視対象ログ 1 つにつき ¥112 (1 か月あたり),,
,,,5 分間隔: 監視対象ログ 1 つにつき ¥168 (1 か月あたり),,
,アクティビティ ログ,無制限,Free,,
,動的しきい値11,なし,動的しきい値あたりの ¥11.200/月,,
通知,ITSM コネクタの作成イベントまたは更新イベント12,"1 か月あたりイベント 1,000 件","¥560/1,000 イベント",,
,メール,"1 か月あたりメール 1,000 通","メール 100,000 通につき ¥224",,
,(Azure Mobile Apps への) プッシュ通知,"1 か月あたり通知 1,000 件","通知 100,000 回につき ¥224",,
,Web hook をセキュリティで保護する,セキュリティ保護された 1 つの Web hook,"セキュリティ保護された ¥672/1,000,000 の Web hook",,
,webhook,"1 か月あたりの webhook 100,000 件","webhook 1,000,000 件につき ¥67.20",,
,音声通話,1 か月あたり音声通話 10 件,音声通話 1 回につき ¥1.456,,
,SMS,日本 (+81),¥5.152/SMS,,
,,,,,
,,,,,
メトリックの保有期間,,,,,
,,,,,
Azure の多くのリソースでは、メトリックは 93 日間保存されます。 ただし、例外があります。,,,,,
クラシック ゲストの OS メトリック。 クラシック ゲストの OS メトリックは 14 日間保持されます。 保有期間が長い場合、Windows Diagnostic Extension (WAD) を使用して収集した新規ゲスト OS メトリックを使用し、Linux 仮想マシンの場合は InfluxData Telegraf エージェントを使用することをお勧めします。,,,,,
Application Insights ログベースのメトリック バック グラウンドでログ ベースのメトリックをログ クエリに変換します。 そのリテンション期間は、基になるログのイベントのリテンション期間と一致します。 Application Insights リソースの場合、ログは 90 日間保存されます。,,,,,
,,,,,
,,,,,
データはどれだけの期間保持されますか。,,,,,
生データ ポイント (つまり、Analytics でクエリを実行したり Search で調べることができる項目) は、最大 90 日間保持されます。 それ以上長くデータを保持する必要がある場合は、 連続エクスポート を使用してストレージ アカウントにコピーすることができます。,,,,,
集計されたデータ (つまり、メトリックス エクスプローラーに表示されるカウント、平均、その他の統計データ) は、1 分の詳細度であれば 90 日の期間にわたって保持されます。,,,,,
